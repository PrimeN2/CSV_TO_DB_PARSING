# Research

## Проблемы с оригинальными .csv

### 1. `Clients.csv`
#### Экранирование кавычек
- Пример: `"ООО ""Положение"" ИНН..."`
- **Риск**: Нарушение структуры CSV при отсутствии корректной обработки кавычек.

#### Валидность ИНН
- **Ошибка**: ИНН в записи `CL_10061` содержит 9 цифр (пример: `7940585529`).
- **Правило**: ИНН юридических лиц должен быть 10-значным.

---

### 2. `Products.csv`
#### Нестандартные символы
- Пример: `"Кисть синтетика круглая ""Вернисаж""..."`
- **Решение**: Обработка спецсимволов при парсинге.

#### Иерархия `Product_Key`
- Формат `X_X_X` предполагает структуру категорий.
- **Проблема**: Отсутствие четких правил усложняет анализ.

---

### 3. `Sales.csv`
#### Формат чисел
- **Десятичные запятые**: `113,33` вместо `113.33`.
- **Экспоненциальная запись**: `1.4210854715202E-13` в скидках.
- **Отрицательные скидки**: `-0,0069999999999837`.

#### Некорректные данные
- **NULL в обязательных полях**: Себестоимость, Номер чека.
- **Смешанные типы**: Номер чека содержит `NULL` и строки (например, `SLS_16357` из `Sums_Check.csv`).

#### Формат даты
- `DD.MM.YYYY` не распознается SQLite автоматически.

---

### 4. `Sums_Check.csv`
#### Конфликт имен столбцов
- Название `Сумма покупки|Сумма` содержит недопустимый символ `|`.

#### Расхождения с `Sales.csv`
- **Суммы**: Пример: `14207,5` для `CL_01` не совпадает с агрегацией из `Sales.csv`.
- **Номера чеков**: `SLS_16353` отсутствует в `Sales.csv` (все чеки = `NULL`).

---

### 5. Общие проблемы
#### Кодировка
- **Кириллица**: Требуется указание UTF-8 для корректного отображения.

#### Нормализация данных
- **Филиал/Адрес**: Составные поля (например, `г. Саратов, ул. Спортивная...`) требуют разделения.
- **Группа товара**: Пример: `Кисти-Акв-Колонок-Соболь` → отдельная таблица категорий.

#### Целостность внешних ключей
- `Client_ID` в `Sales/Sums_Check` должен существовать в `Clients.csv`.
- `Product_Key` в `Sales` должен быть в `Products.csv`.

---

### Необходимые изменения
1. **Формат чисел**: Замена запятых на точки (например, `113,33` → `113.33`).
2. **Даты**: Преобразование в `YYYY-MM-DD`.
3. **Символы**: Обработка кавычек и спецсимволов при импорте.
4. **Проверка данных**:
   - Валидация ИНН.
   - Уникальность ключей.
5. **Нормализация**:
   - Разделение составных полей.
   - Создание таблиц для категорий.
6. **NULL-значения**: Замена на допустимые значения в ключевых полях.
7. **Транзакции**: Использование для синхронизации `Sales.csv` и `Sums_Check.csv`.

---

## Не соответсвия с 3НФ

